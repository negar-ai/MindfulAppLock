#: import Factory kivy.factory.Factory

<RoundedButton@Button>:
    background_color: 0, 0, 0, 0  # Transparent background
    background_normal: ''
    canvas.before:
        Color:
            rgba: (0.34, 0.71, 0.73, 1) if self.state == 'normal' else (0.24, 0.61, 0.63, 1)  # Default color, changes when pressed
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [60, 60, 60, 60]

<RoundedButtonEm@Button>:
    background_color: 0, 0, 0, 0  # Transparent background
    background_normal: ''
    canvas.before:
        Color:
            rgba: (1, 0.31, 0.17,1) if self.state == 'normal' else (0.24, 0.61, 0.63, 1)  # Default color, changes when pressed
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [60, 60, 60, 60]
<MainScreen>:     
    orientation: 'vertical'     
    padding: 40     
    spacing: 30     
    canvas.before:         
        Color:             
            rgba: 0.99, 0.97, 0.93, 1  # Off white background         
        Rectangle:             
            pos: self.pos             
            size: self.size      
    
    Label:         
        text: root.message         
        font_name: "Chocolate Covered Raindrops.ttf"         
        font_size: 50         
        color: 0, 0.31, 0.31, 1  # Deep Teal text         
        halign: 'center'         
        valign: 'middle'         
        text_size: self.size         
        size_hint: (1, 0.4)       
    
    RoundedButton:         
        text: "Start Challenge"         
        font_name: "Chocolate Covered Raindrops BOLD.ttf"         
        font_size: 60         
        color: 0, 0.31, 0.31, 1  # Deep Teal text         
        size_hint: (0.8, 0.12)         
        pos_hint: {"center_x": 0.5}         
        on_press: root.manager.current = 'breathing_task_screen'  # This navigates to BreathingTaskScreen   
    
    RoundedButtonEm:         
        text: "Emergency Access"         
        font_name: "Chocolate Covered Raindrops BOLD.ttf"         
        font_size: 60              
        color: 1, 1, 1, 1  # White text         
        size_hint: (0.8, 0.12)         
        pos_hint: {"center_x": 0.5}         
        on_press: root.emergency_unlock()

<BreathingTaskScreen>:
    orientation: 'vertical'
    padding: 40
    spacing: 30

    Label:
        id: breathing_instruction
        text: "Inhale..."
        font_size: 40
        color: 0, 0.31, 0.31, 1  # Deep Teal text
        halign: 'center'
        valign: 'middle'
        size_hint: (1, 0.4)

    Label:
        id: timer_label
        text: "00:00"
        font_size: 80
        color: 0, 0, 0, 1  # Black text
        halign: 'center'
        valign: 'middle'
        size_hint: (1, 0.4)

    Button:
        text: "Complete Task"
        font_size: 30
        size_hint: (0.8, 0.1)
        pos_hint: {"center_x": 0.5}
        on_press: root.complete_task()
